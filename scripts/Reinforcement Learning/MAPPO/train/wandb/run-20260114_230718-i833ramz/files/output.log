WandB initialized: grid3x3_4cubes_isaacsim_test
Initializing detailed logger...
[LOGGER] Saving logs to: C:\isaacsim\cobotproject\scripts\Reinforcement Learning\MAPPO\logs
[LOGGER] CSV: C:\isaacsim\cobotproject\scripts\Reinforcement Learning\MAPPO\logs\mappo_rrt_isaacsim_grid3_cubes4_20260114_230707_20260114_230738_episode_log.csv

Creating Franka RRT Trainer...
[TRAINER] Initializing Franka RRT Trainer for MAPPO
[TRAINER] Grid: 3x3, Cubes: 4
[TRAINER] Setting up scene...
[TRAINER] Initializing RRT planner...
[TRAINER] RRT planner and kinematics solvers initialized
[TRAINER] Adding container...
[TRAINER] Creating random obstacles in empty cells...
[TRAINER] Scene setup complete

Creating Isaac Sim RRT environment...
[IsaacSimRRT] All components initialized - using actual Isaac Sim RRT
Isaac Sim environment created with Franka controller and RRT planner

Loading frozen DDQN agent (Agent 1)...
[Double DQN] Initialized agent on cuda
[Double DQN] State dim: 54, Action dim: 9
[Double DQN] Epsilon decay: multiplicative
[Double DQN] Target update: soft (tau=0.005)
[Double DQN] Warmup steps: 1000
[Double DQN] Loaded checkpoint from C:\isaacsim\cobotproject\scripts\Reinforcement Learning\doubleDQN_script\models\ddqn_rrt_isaacsim_grid3_cubes4_20251223_203144_final.pt
[Double DQN] Epsilon: 0.0100, Steps: 50000, Episodes: 12500
[Double DQN] Loaded 49001 loss values
[Double DQN] Loaded 49001 Q-value records
DDQN agent loaded from C:\isaacsim\cobotproject\scripts\Reinforcement Learning\doubleDQN_script\models\ddqn_rrt_isaacsim_grid3_cubes4_20251223_203144_final.pt and frozen

Creating two-agent environment...
Two-agent environment created

Creating MAPPO policy (Agent 2)...
MAPPO policy created: obs_dim=38, action_dim=36
MAPPO trainer created
Rollout buffer created: size=256

Initialization complete. Starting training...
================================================================================
[RESHUFFLE] Moved cube 1 (Cube_2) to [ 0.3     -0.25     0.02575]
[RESHUFFLE] Cube 1: UNREACHABLE_DISTANCE (priority=3)
            Old: [0.6169509  0.04729804 0.0257497 ] (dist=0.619m)
            New: [ 0.3     -0.25     0.02575] (dist=0.391m)
            Improvement: +0.228m (+36.8%)
[RESHUFFLE] Moved cube 2 (Cube_3) to [ 0.45    -0.1      0.02575]
[RESHUFFLE] Cube 2: FAR_CUBE (priority=2)
            Old: [0.31715706 0.0466894  0.02574972] (dist=0.322m)
            New: [ 0.45    -0.1      0.02575] (dist=0.462m)
            Improvement: -0.140m (-43.6%)
[RESHUFFLE] Moved cube 2 (Cube_3) to [ 0.45    -0.25     0.02575]
[RESHUFFLE] Cube 2: UNREACHABLE_DISTANCE (priority=3)
            Old: [ 0.45    -0.1      0.02575] (dist=0.462m)
            New: [ 0.45    -0.25     0.02575] (dist=0.515m)
            Improvement: -0.054m (-11.6%)
[RESHUFFLE] Moved cube 2 (Cube_3) to [ 0.3     -0.1      0.02575]
[RESHUFFLE] Cube 2: CROWDED_AREA (priority=3)
            Old: [0.45946145 0.05194997 0.02574975] (dist=0.463m)
            New: [ 0.3     -0.1      0.02575] (dist=0.317m)
            Improvement: +0.146m (+31.5%)
[RESHUFFLE] Moved cube 2 (Cube_3) to [0.45    0.05    0.02575]
[RESHUFFLE] Cube 2: UNREACHABLE_DISTANCE (priority=3)
            Old: [ 0.3     -0.1      0.02575] (dist=0.317m)
            New: [0.45    0.05    0.02575] (dist=0.454m)
            Improvement: -0.136m (-42.9%)
[RESHUFFLE] Moved cube 1 (Cube_2) to [ 0.3     -0.1      0.02575]
[RESHUFFLE] Cube 1: FAR_CUBE (priority=2)
            Old: [ 0.6145766  -0.10541828  0.02574964] (dist=0.624m)
            New: [ 0.3     -0.1      0.02575] (dist=0.317m)
            Improvement: +0.307m (+49.2%)
[RESHUFFLE] Moved cube 2 (Cube_3) to [ 0.45    -0.1      0.02575]
[RESHUFFLE] Cube 2: UNREACHABLE_DISTANCE (priority=3)
            Old: [0.6133618  0.06495357 0.02574981] (dist=0.617m)
            New: [ 0.45    -0.1      0.02575] (dist=0.462m)
            Improvement: +0.156m (+25.2%)
[RESHUFFLE] Moved cube 3 (Cube_4) to [0.6     0.05    0.02575]
[RESHUFFLE] Cube 3: CROWDED_AREA (priority=3)
            Old: [ 0.6158916  -0.11899334  0.02574968] (dist=0.628m)
            New: [0.6     0.05    0.02575] (dist=0.603m)
            Improvement: +0.025m (+4.0%)
[RESHUFFLE] Moved cube 0 (Cube_1) to [ 0.3     -0.1      0.02575]
[RESHUFFLE] Cube 0: UNREACHABLE_DISTANCE (priority=3)
            Old: [ 0.58942264 -0.09687651  0.0257497 ] (dist=0.598m)
            New: [ 0.3     -0.1      0.02575] (dist=0.317m)
            Improvement: +0.281m (+46.9%)
[RESHUFFLE] Moved cube 3 (Cube_4) to [ 0.45    -0.25     0.02575]
[RESHUFFLE] Cube 3: FAR_CUBE (priority=2)
            Old: [0.6005135  0.04379401 0.02574963] (dist=0.603m)
            New: [ 0.45    -0.25     0.02575] (dist=0.515m)
            Improvement: +0.087m (+14.5%)
[RESHUFFLE] Moved cube 0 (Cube_1) to [ 0.45    -0.1      0.02575]
[RESHUFFLE] Cube 0: UNREACHABLE_DISTANCE (priority=3)
            Old: [ 0.3     -0.1      0.02575] (dist=0.317m)
            New: [ 0.45    -0.1      0.02575] (dist=0.462m)
            Improvement: -0.144m (-45.5%)
[RESHUFFLE] Moved cube 2 (Cube_3) to [ 0.45    -0.1      0.02575]
[RESHUFFLE] Cube 2: UNREACHABLE_DISTANCE (priority=3)
            Old: [ 0.44063604 -0.24030262  0.02574739] (dist=0.503m)
            New: [ 0.45    -0.1      0.02575] (dist=0.462m)
            Improvement: +0.041m (+8.1%)
[RESHUFFLE] Moved cube 0 (Cube_1) to [ 0.3     -0.1      0.02575]
[RESHUFFLE] Cube 0: FAR_CUBE (priority=2)
            Old: [ 0.5891958  -0.26415163  0.02574764] (dist=0.646m)
            New: [ 0.3     -0.1      0.02575] (dist=0.317m)
            Improvement: +0.329m (+50.9%)
[RESHUFFLE] Moved cube 3 (Cube_4) to [0.6     0.05    0.02575]
[RESHUFFLE] Cube 3: FAR_CUBE (priority=2)
            Old: [ 0.31595382 -0.25504914  0.0257474 ] (dist=0.407m)
            New: [0.6     0.05    0.02575] (dist=0.603m)
            Improvement: -0.196m (-48.1%)
[RESHUFFLE] Moved cube 3 (Cube_4) to [0.45    0.05    0.02575]
[RESHUFFLE] Cube 3: FAR_CUBE (priority=2)
            Old: [0.6     0.05    0.02575] (dist=0.603m)
            New: [0.45    0.05    0.02575] (dist=0.454m)
            Improvement: +0.149m (+24.7%)
[RESHUFFLE] Moved cube 3 (Cube_4) to [0.3     0.05    0.02575]
[RESHUFFLE] Cube 3: CROWDED_AREA (priority=3)
            Old: [ 0.46528828 -0.237123    0.02574916] (dist=0.523m)
            New: [0.3     0.05    0.02575] (dist=0.305m)
            Improvement: +0.218m (+41.6%)
[RESHUFFLE] Moved cube 0 (Cube_1) to [ 0.45    -0.25     0.02575]
[RESHUFFLE] Cube 0: CROWDED_AREA (priority=3)
            Old: [ 0.43538815 -0.08952934  0.02574917] (dist=0.445m)
            New: [ 0.45    -0.25     0.02575] (dist=0.515m)
            Improvement: -0.070m (-15.8%)
[RESHUFFLE] Moved cube 2 (Cube_3) to [0.6     0.05    0.02575]
[RESHUFFLE] Cube 2: FAR_CUBE (priority=2)
            Old: [ 0.5827449  -0.09451657  0.02574918] (dist=0.591m)
            New: [0.6     0.05    0.02575] (dist=0.603m)
            Improvement: -0.012m (-2.0%)
[RESHUFFLE] Moved cube 3 (Cube_4) to [ 0.45    -0.1      0.02575]
[RESHUFFLE] Cube 3: UNREACHABLE_DISTANCE (priority=3)
            Old: [0.30382773 0.04662098 0.02574769] (dist=0.308m)
            New: [ 0.45    -0.1      0.02575] (dist=0.462m)
            Improvement: -0.153m (-49.7%)
[RESHUFFLE] Moved cube 1 (Cube_2) to [ 0.3     -0.1      0.02575]
[RESHUFFLE] Cube 1: CROWDED_AREA (priority=3)
            Old: [ 0.58538026 -0.11265723  0.02574767] (dist=0.597m)
            New: [ 0.3     -0.1      0.02575] (dist=0.317m)
            Improvement: +0.279m (+46.8%)
[RESHUFFLE] Moved cube 1 (Cube_2) to [0.6     0.05    0.02575]
[RESHUFFLE] Cube 1: UNREACHABLE_DISTANCE (priority=3)
            Old: [ 0.3     -0.1      0.02575] (dist=0.317m)
            New: [0.6     0.05    0.02575] (dist=0.603m)
            Improvement: -0.285m (-89.9%)
[RESHUFFLE] Moved cube 2 (Cube_3) to [ 0.45    -0.1      0.02575]
[RESHUFFLE] Cube 2: CROWDED_AREA (priority=3)
            Old: [ 0.6013248  -0.09196998  0.02574914] (dist=0.609m)
            New: [ 0.45    -0.1      0.02575] (dist=0.462m)
            Improvement: +0.147m (+24.2%)
[RESHUFFLE] Moved cube 2 (Cube_3) to [ 0.6     -0.25     0.02575]
[RESHUFFLE] Cube 2: UNREACHABLE_DISTANCE (priority=3)
            Old: [ 0.45    -0.1      0.02575] (dist=0.462m)
            New: [ 0.6     -0.25     0.02575] (dist=0.651m)
            Improvement: -0.189m (-40.9%)
[RESHUFFLE] Moved cube 2 (Cube_3) to [ 0.6     -0.1      0.02575]
[RESHUFFLE] Cube 2: FAR_CUBE (priority=2)
            Old: [ 0.6     -0.25     0.02575] (dist=0.651m)
            New: [ 0.6     -0.1      0.02575] (dist=0.609m)
            Improvement: +0.042m (+6.4%)
[RESHUFFLE] Moved cube 2 (Cube_3) to [ 0.3     -0.1      0.02575]
[RESHUFFLE] Cube 2: UNREACHABLE_DISTANCE (priority=3)
            Old: [ 0.61275554 -0.10530043  0.02574766] (dist=0.622m)
            New: [ 0.3     -0.1      0.02575] (dist=0.317m)
            Improvement: +0.305m (+49.0%)
[RESHUFFLE] Moved cube 2 (Cube_3) to [ 0.45    -0.1      0.02575]
[RESHUFFLE] Cube 2: FAR_CUBE (priority=2)
            Old: [ 0.3     -0.1      0.02575] (dist=0.317m)
            New: [ 0.45    -0.1      0.02575] (dist=0.462m)
            Improvement: -0.144m (-45.5%)
[RESHUFFLE] Moved cube 0 (Cube_1) to [ 0.3     -0.25     0.02575]
[RESHUFFLE] Cube 0: UNREACHABLE_DISTANCE (priority=3)
            Old: [ 0.4356679  -0.11726908  0.02574768] (dist=0.452m)
            New: [ 0.3     -0.25     0.02575] (dist=0.391m)
            Improvement: +0.061m (+13.4%)
[RESHUFFLE] Moved cube 2 (Cube_3) to [ 0.3     -0.1      0.02575]
[RESHUFFLE] Cube 2: FAR_CUBE (priority=2)
            Old: [ 0.5822074  -0.09931336  0.02574917] (dist=0.591m)
            New: [ 0.3     -0.1      0.02575] (dist=0.317m)
            Improvement: +0.274m (+46.3%)
[RESHUFFLE] Moved cube 1 (Cube_2) to [ 0.6     -0.25     0.02575]
[RESHUFFLE] Cube 1: FAR_CUBE (priority=2)
            Old: [ 0.46403006 -0.2560141   0.02574918] (dist=0.531m)
            New: [ 0.6     -0.25     0.02575] (dist=0.651m)
            Improvement: -0.120m (-22.6%)
[RESHUFFLE] Moved cube 1 (Cube_2) to [0.45    0.05    0.02575]
[RESHUFFLE] Cube 1: UNREACHABLE_DISTANCE (priority=3)
            Old: [0.29842266 0.05065794 0.02574807] (dist=0.304m)
            New: [0.45    0.05    0.02575] (dist=0.454m)
            Improvement: -0.150m (-49.3%)
[RESHUFFLE] Moved cube 2 (Cube_3) to [ 0.45    -0.1      0.02575]
[RESHUFFLE] Cube 2: FAR_CUBE (priority=2)
            Old: [ 0.6171702  -0.26991773  0.02574767] (dist=0.674m)
            New: [ 0.45    -0.1      0.02575] (dist=0.462m)
            Improvement: +0.212m (+31.5%)
[RESHUFFLE] Moved cube 0 (Cube_1) to [ 0.6     -0.25     0.02575]
[RESHUFFLE] Cube 0: UNREACHABLE_DISTANCE (priority=3)
            Old: [0.58327115 0.05329872 0.02574766] (dist=0.586m)
            New: [ 0.6     -0.25     0.02575] (dist=0.651m)
            Improvement: -0.064m (-11.0%)
[RESHUFFLE] Moved cube 2 (Cube_3) to [0.6     0.05    0.02575]
[RESHUFFLE] Cube 2: FAR_CUBE (priority=2)
            Old: [ 0.43965593 -0.09364537  0.02574918] (dist=0.450m)
            New: [0.6     0.05    0.02575] (dist=0.603m)
            Improvement: -0.152m (-33.8%)

Training complete! Final model saved: C:\isaacsim\cobotproject\scripts\Reinforcement Learning\MAPPO\models\mappo_rrt_isaacsim_grid3_cubes4_20260114_230707_final.pt

[LOGGER] Training summary saved to: C:\isaacsim\cobotproject\scripts\Reinforcement Learning\MAPPO\logs\mappo_rrt_isaacsim_grid3_cubes4_20260114_230707_summary.json
[LOGGER] Total episodes: 13
[LOGGER] Average reward: 4.85
[LOGGER] Average reshuffles: 2.54
[LOGGER] Logs saved successfully!
